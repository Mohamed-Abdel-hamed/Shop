<div class="container d-flex justify-content-center align-items-center">

  <div [class.d-none]="!isFailedUpdate" class="alert alert-warning" role="alert">
   {{failedUpdateMessage}}
</div>

<div [class.d-none]="!isComplete" class="alert alert-success" role="alert">
   success Upadte account.
</div>
  <form
  [class.d-none]="isComplete||isFailedUpdate"
    [formGroup]="updateForm"
    class="bg-light p-4 rounded-4 shadow form w-100"
    (ngSubmit)="submit(updateForm)"
  >
    <!-- FIRST NAME -->
    <div class="mb-3">
      <label for="firstName" class="form-label">First name</label>
      <input
        type="text"
        id="firstName"
        formControlName="firstName"
        class="form-control rounded-5"
        [ngClass]="{
          'border border-danger':
            updateForm.get('firstName')?.invalid &&
            updateForm.get('firstName')?.touched
        }"
      />

      @if (updateForm.get('firstName')?.invalid && updateForm.get('firstName')?.touched) {
        <div class="d-flex flex-column">
          @if (updateForm.get('firstName')?.errors?.['required']) {
            <span class="text-danger">Please fill out this field.</span>
          }
          @if (updateForm.get('firstName')?.errors?.['maxlength']) {
            <span class="text-danger">You can’t enter more than 50 characters.</span>
          }
          @if (updateForm.get('firstName')?.errors?.['minlength']) {
            <span class="text-danger">Enter at least 3 characters.</span>
          }
        </div>
      }
    </div>

    <!-- LAST NAME -->
    <div class="mb-3">
      <label for="lastName" class="form-label">Last name</label>
      <input
        type="text"
        id="lastName"
        formControlName="lastName"
        class="form-control rounded-5"
        [ngClass]="{
          'border border-danger':
            updateForm.get('lastName')?.invalid &&
            updateForm.get('lastName')?.touched
        }"
      />

      @if (updateForm.get('lastName')?.invalid && updateForm.get('lastName')?.touched) {
        <div class="d-flex flex-column">
          @if (updateForm.get('lastName')?.errors?.['required']) {
            <span class="text-danger">Please fill out this field.</span>
          }
          @if (updateForm.get('lastName')?.errors?.['maxlength']) {
            <span class="text-danger">You can’t enter more than 50 characters.</span>
          }
          @if (updateForm.get('lastName')?.errors?.['minlength']) {
            <span class="text-danger">Enter at least 3 characters.</span>
          }
        </div>
      }
    </div>
    <!-- USER NAME -->
    <div class="mb-3">
      <label for="userName" class="form-label">User name</label>
      <input
        type="text"
        id="userName"
        formControlName="userName"
        class="form-control rounded-5"
        [ngClass]="{
          'border border-danger':
            updateForm.get('userName')?.invalid &&
            updateForm.get('userName')?.touched
        }"
      />

      @if (updateForm.get('userName')?.invalid && updateForm.get('userName')?.touched) {
        <div class="d-flex flex-column">
          @if (updateForm.get('userName')?.errors?.['required']) {
            <span class="text-danger">Please fill out this field.</span>
          }
          @if (updateForm.get('userName')?.errors?.['maxlength']) {
            <span class="text-danger">You can’t enter more than 50 characters.</span>
          }
          @if (updateForm.get('userName')?.errors?.['minlength']) {
            <span class="text-danger">Enter at least 3 characters.</span>
          }
        </div>
      }
    </div>
    <!-- EMAIL -->
    <div class="mb-3">
      <label for="email" class="form-label">Email</label>
      <input
        type="email"
        id="email"
        formControlName="email"
        class="form-control rounded-5"
        [ngClass]="{
          'border border-danger':
            (updateForm.get('email')?.invalid &&
            updateForm.get('email')?.touched)||
            errorMessage.length>0
        }"
        #emailInput
      />

      @if (updateForm.get('email')?.invalid && updateForm.get('email')?.touched) {
        <div class="d-flex flex-column">
          @if (updateForm.get('email')?.errors?.['required']) {
            <span class="text-danger">Email is required.</span>
          }
          @if (updateForm.get('email')?.errors?.['email']) {
            <span class="text-danger">Please enter a valid email address.</span>
          }

        </div>
      }

       @if (errorMessage.length>0) {
            <span class="text-danger">{{errorMessage}}</span>
          }
    </div>
  <!-- Phone-->
    <div class="mb-3">
      <label for="phone" class="form-label">Phone</label>
      <input
        type="text"
        id="phone"
        formControlName="phoneNumber"
        class="form-control rounded-5"
        [ngClass]="{
          'border border-danger':
            updateForm.get('phoneNumber')?.invalid &&
            updateForm.get('phoneNumber')?.touched
        }"
      />

      @if (updateForm.get('phoneNumber')?.invalid && updateForm.get('phoneNumber')?.touched) {
        <div class="d-flex flex-column">
          @if (updateForm.get('phoneNumber')?.errors?.['required']) {
            <span class="text-danger">Email is required.</span>
          }
           @if (updateForm.get('phoneNumber')?.errors?.['pattern']) {
           <span class="text-danger">
             Phone number must be 11 digits and start with 01.
            </span>
          }
        </div>
      }
    </div>

    <!-- SUBMIT -->
    <div class="text-center">
      <button class="btn btn-black no-hover rounded-5 px-4 w-100" type="submit">
       <span [class.d-none]="isLoading">Update</span>
       <div [class.d-none]="!isLoading">
          <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
       </div>
      </button>
    </div>
  </form>
</div>
